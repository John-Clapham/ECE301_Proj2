function [Wnk,k,vk1,vk2,vk3,desiredDFT,highfreq,lowfreq] = DTMFfinder(t_start,t_end)
% Function outputs 2 DTMF frequencies for a single digit
% Needs t_start and t_end which is a phone beep
load all_datasets_project2.mat;
dig = dataset1(t_start:t_end);


freq_table = [697 770 852 941 1209 1336 1477 1633];
q = zeros(1,10);
fs = 44100;
N = 105;

k = zeros;
for i = 1:length(freq_table)
    k(i) = N * (freq_table(i)/fs);
end

vk = zeros(1,N+2);
 for n = 3:N+2
    vk1(n) = (2*cos((2*pi*k(1))/N)*vk1(n-1))-vk(n-2)+dig(n);
    vk2(n) = (2*cos((2*pi*k(2))/N)*vk2(n-1))-vk(n-2)+dig(n); 
    vk3(n) = (2*cos((2*pi*k(3))/N)*vk3(n-1))-vk(n-2)+dig(n); 
    vk4(n) = (2*cos((2*pi*k(4))/N)*vk4(n-1))-vk(n-2)+dig(n); 
    vk5(n) = (2*cos((2*pi*k(5))/N)*vk5(n-1))-vk(n-2)+dig(n);
    vk6(n) = (2*cos((2*pi*k(6))/N)*vk6(n-1))-vk(n-2)+dig(n);
    vk7(n) = (2*cos((2*pi*k(7))/N)*vk7(n-1))-vk(n-2)+dig(n);
    vk8(n) = (2*cos((2*pi*k(8))/N)*vk8(n-1))-vk(n-2)+dig(n);
 end
 
 Wnk = zeros;
 
 for n = 1:length(freq_table)
     Wnk(n) = exp((-2)*pi*(k(n)/N));
 end
 
 ykN1 = vk1(N+2)-(Wnk(1)*vk(N-1));
 ykN2 = vk1(N+2)-(Wnk(2)*vk(N-1));
 ykN3 = vk1(N+2)-(Wnk(3)*vk(N-1));
 ykN4 = vk1(N+2)-(Wnk(4)*vk(N-1));
 ykN5 = vk1(N+2)-(Wnk(5)*vk(N-1));
 ykN6 = vk1(N+2)-(Wnk(6)*vk(N-1));
 ykN7 = vk1(N+2)-(Wnk(7)*vk(N-1));
 ykN8 = vk1(N+2)-(Wnk(8)*vk(N-1));
 
 desiredDFT = [ykN1 ykN2 ykN3 ykN4 ykN5 ykN6 ykN7 ykN8];
% for i = 1:length(freq_table)
%     num = 1;
%     %den = [1 (-2)*(cos(freq_table(i))) 1]; % Where the cosine argument is the frequency of interest
%     %den = [1 -exp(1i*i)];
%     den = [1 (-2)*(cos(2*pi*k(i)/N)) 1];
%     
%     goertzel_filt = filter(num, den, dig);
%     %figure;plot(goertzel_filt)
%     %title(strcat("Goertzel freq ",num2str(freq_table(i))))
%     
%     q(i) = trapz(abs(goertzel_filt));
% end

% max_freqs = maxk(q,2);
% lowfreq = freq_table(find(q == max_freqs(1)));
% highfreq = freq_table(find(q == max_freqs(2)));
lowfreq = 'myass';
highfreq = 'myotherass';
end

